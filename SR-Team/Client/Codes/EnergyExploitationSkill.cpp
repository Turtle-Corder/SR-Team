#include "stdafx.h"
#include "..\Headers\EnergyExploitationSkill.h"


USING(Client)

CEnergyExploitationSkill::CEnergyExploitationSkill(LPDIRECT3DDEVICE9 _pDevice, LPD3DXSPRITE _pSprite, LPD3DXFONT _pFont)
	: CPlayerSkill(_pDevice, _pSprite, _pFont)
{
}

CEnergyExploitationSkill::CEnergyExploitationSkill(const CEnergyExploitationSkill & _rOther)
	: CPlayerSkill(_rOther)
{
}

HRESULT CEnergyExploitationSkill::Setup_GameObject_Prototype()
{
	return S_OK;
}

HRESULT CEnergyExploitationSkill::Setup_GameObject(void * _pArg)
{
	m_fStartTime = 0.f;
	m_fEndTime = 100.f;

	return S_OK;
}

_int CEnergyExploitationSkill::Update_GameObject(_float _fDeltaTime)
{
	if (!m_bInitial)
		m_fStartTime += _fDeltaTime;

	return GAMEOBJECT::NOEVENT;
}

_int CEnergyExploitationSkill::LateUpdate_GameObject(_float _fDeltaTime)
{
	return GAMEOBJECT::NOEVENT;
}

CEnergyExploitationSkill * CEnergyExploitationSkill::Create(LPDIRECT3DDEVICE9 pDevice, LPD3DXSPRITE _pSprite, LPD3DXFONT _pFont)
{
	if (nullptr == pDevice)
		return nullptr;

	CEnergyExploitationSkill* pInstance = new CEnergyExploitationSkill(pDevice, _pSprite, _pFont);
	if (FAILED(pInstance->Setup_GameObject_Prototype()))
	{
		PRINT_LOG(L"Failed To Create CEnergyExploitationSkill", LOG::CLIENT);
		Safe_Release(pInstance);
	}

	return pInstance;
}

CGameObject * CEnergyExploitationSkill::Clone_GameObject(void * _pArg)
{
	CEnergyExploitationSkill* pInstance = new CEnergyExploitationSkill(*this);
	if (FAILED(pInstance->Setup_GameObject(_pArg)))
	{
		PRINT_LOG(L"Failed To Clone CEnergyExploitationSkill", LOG::CLIENT);
		Safe_Release(pInstance);
	}

	return pInstance;
}

HRESULT CEnergyExploitationSkill::Use_Skill(float fDeltaTime)
{
	// 쿨타임 검사
	if (m_bInitial)
	{
		PRINT_LOG(L"공격력 버프 사용", LOG::CLIENT);
		m_bInitial = false;
	}
	else if (m_fStartTime <= m_fEndTime)
	{
		PRINT_LOG(L"쿨타임중", LOG::CLIENT);
		return E_FAIL;
	}
	else if (m_fStartTime >= m_fEndTime)
	{
		m_fStartTime = 0.f;
		PRINT_LOG(L"쿨타임 끝 / 공격력 버프 사용", LOG::CLIENT);
	}

	return S_OK;
}
